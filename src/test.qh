#[stddef.hyy];

#(file_metadata) <- {
  #(file) <- {
    #(file_name) <- 'test',
    #(file_type) <- 'qh'
  },
  #(author) <- 'Heyangyang',
  #(description) <- 'test'
};

---- test.qh ----

*[#(V)] -> {
  *[#(C)#(_)c] >> {
    *[a] >> [ ai+e                    ],
    *[e] >> [ oi   | ie   | ec | ique ],
    *[i] >> [ ei+e | ille | ic | ique ],
    *[o] >> [ eu+e                    ],
    *[u] >> [ oui+lle                 ]
  },
  *[#(_)c=#(V)] >> {
    *[a] >> [ aill#(inv)  ],
    *[e] >> [ eill#(inv)  ],
    *[i] >> [ euill#(inv) ],
    *[o] >> [ oeill#(inv) ],
    *[u] >> [ oui#(inv)   ]
  },
  *[#(_)=#(C)] >> {
    *[a] >> [ aue ],
    *[e] >> [ ao  ],
    *[i] >> [ éu  ],
    *[o] >> [ aoû ],
    *[u] >> [ eue ]
  },
  *[=#(Cs)#(_)#(Cs)=] >> {
    *[a] >> [ a ],
    *[e] >> [ e ],
    *[i] >> [ i ],
    *[o] >> [ o ],
    *[u] >> [ u ]
  }
};

[] -> {
  {
    [
      *[=#(Cs)]
      #(_)
      *[#(Cs)#(V)@0#(Cs)=]
    ]
    |
    [
      *[=#(Cs)#(V)@0#(Cs)]
      #(_)
      *[#(Cs)=]
    ]
  } >> {
    *[a]@0 >> [ i ],
    *[e]@0 >> [ a ],
    *[i]@0 >> [ e ],
    *[o]@0 >> [ o ],
    *[u]@0 >> [ u ]
  },
}

*[#(V)[r|l]] -> {
  *[#(_)=a] >> {
    *[ar] >> [ aù   ],
    *[er] >> [ ae   ],
    *[ir] >> [ éa   ],
    *[or] >> [ oe   ],
    *[ur] >> [ eù   ],
    *[al] >> [ au   ],
    *[el] >> [ aeau ],
    *[il] >> [ ieu  ],
    *[ol] >> [ ou   ],
    *[ul] >> [ oû   ]
  },
  *[#(_)=#(C)] >> {
    *[ar] >> [ oî  ],
    *[er] >> [ ea  ],
    *[ir] >> [ éo  ],
    *[or] >> [ oa  ],
    *[ur] >> [ oo  ],
    *[al] >> [ aie ],
    *[el] >> [ oie ],
    *[il] >> [ î   ],
    *[ol] >> [ oue ],
    *[ul] >> [ eou ]
  }
}

*[#(inv)#(V)] -> {
  *[#(inv)a] >> [e],
  *[#(inv)e] >> [é],
  *[#(inv)i] >> [i],
  *[#(inv)o] >> [è],
  *[#(inv)u] >> [eu]
};

